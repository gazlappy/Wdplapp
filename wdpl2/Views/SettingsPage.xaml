<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="Wdpl2.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:models="clr-namespace:Wdpl2.Models"
    Title="Settings">

    <!-- Split grid: 1* (categories) | 2* (editor) -->
    <Grid x:Name="RootGrid" Padding="12" ColumnSpacing="12" RowSpacing="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="2*"/>
        </Grid.ColumnDefinitions>
        
        <!-- Header -->
        <Label 
            Grid.ColumnSpan="2"
            Text="Settings" 
            Style="{StaticResource PageTitleStyle}" />

        <!-- LEFT: Settings Categories -->
        <Border 
            Grid.Row="1"
            Grid.Column="0"
            StrokeShape="RoundRectangle 12" 
            Padding="{StaticResource MediumPadding}"
            BackgroundColor="{AppThemeBinding Light=#FAFAFA, Dark=#1A1A1A}"
            Stroke="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray700}}"
            StrokeThickness="1">
            <VerticalStackLayout Spacing="{StaticResource StandardSpacing}">
                <Label Text="Categories" Style="{StaticResource SectionHeaderStyle}" Margin="0" />
                <CollectionView
                    x:Name="CategoriesList"
                    SelectionMode="Single"
                    SelectionChanged="OnCategorySelectionChanged"
                    ItemsLayout="VerticalList">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="x:String">
                            <Border
                                Padding="12,16"
                                Margin="0,0,0,8"
                                BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#2A2A2A}"
                                StrokeThickness="0"
                                StrokeShape="RoundRectangle 8"
                                MinimumHeightRequest="50">
                                <Border.Triggers>
                                    <DataTrigger 
                                        TargetType="Border"
                                        Binding="{Binding Source={RelativeSource AncestorType={x:Type CollectionView}}, Path=SelectedItem}"
                                        Value="{Binding .}">
                                        <Setter Property="BackgroundColor" Value="{AppThemeBinding Light=#E0F2FE, Dark=#0C4A6E}" />
                                        <Setter Property="Stroke" Value="{AppThemeBinding Light=#0284C7, Dark=#38BDF8}" />
                                        <Setter Property="StrokeThickness" Value="2" />
                                    </DataTrigger>
                                </Border.Triggers>
                                <Label 
                                    Text="{Binding}" 
                                    FontSize="14"
                                    FontAttributes="Bold"
                                    VerticalTextAlignment="Center"
                                    HorizontalTextAlignment="Start" />
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </Border>

        <!-- RIGHT: Settings Editor -->
        <Border 
            Grid.Row="1"
            Grid.Column="1"
            StrokeShape="RoundRectangle 12" 
            Padding="{StaticResource MediumPadding}"
            BackgroundColor="{AppThemeBinding Light=#FAFAFA, Dark=#1A1A1A}"
            Stroke="{AppThemeBinding Light={StaticResource Gray200}, Dark={StaticResource Gray700}}"
            StrokeThickness="1">
            <ScrollView>
                <ContentView x:Name="ContentPanel" Padding="{StaticResource MediumPadding}"/>
            </ScrollView>
        </Border>
    </Grid>
</ContentPage>