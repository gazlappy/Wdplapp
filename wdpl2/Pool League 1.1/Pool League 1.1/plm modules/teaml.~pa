unit Teaml;

interface

uses WinTypes, WinProcs, Classes, Graphics, Forms, Controls, Buttons,
  StdCtrls, DB, DBTables, Grids, DBGrids, ExtCtrls,
  Dialogs, SysUtils;

type
  TTeamList = class(TForm)
    OKBtn: TBitBtn;
    Bevel1: TBevel;
    Team: TTable;
    TeamSource: TDataSource;
    DBGrid1: TDBGrid;
    Button1: TButton;
    Delete: TButton;
    Amend: TButton;
    DeleteQuery: TQuery;
    TeamTeamName: TStringField;
    TeamVenue: TStringField;
    TeamDivision: TStringField;
    TeamContact: TStringField;
    TeamContactAddress1: TStringField;
    TeamContactAddress2: TStringField;
    TeamContactAddress3: TStringField;
    TeamContactAddress4: TStringField;
    procedure FormCreate(Sender: TObject);
    procedure OKBtnClick(Sender: TObject);
    procedure DeleteClick(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure AmendClick(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  TeamList: TTeamList;

implementation

uses team, Main;
{$R *.DFM}

procedure TTeamList.FormCreate(Sender: TObject);
begin
  Team.Open;
end;

procedure TTeamList.OKBtnClick(Sender: TObject);
begin
  Team.Close;
  Close;
end;

procedure TTeamList.DeleteClick(Sender: TObject);
var
  Key: string;
begin
  Key := DBGrid1.Fields[0].AsString;
  if MessageDlg(Format('Delete "%S" from the Team table?', [Key]),
    mtConfirmation, mbOKCancel, 0) = mrOK then
  begin
    DeleteQuery.Prepare;
    DeleteQuery.Params[0].AsString := Key;
    DeleteQuery.ExecSQL;
    Team.Refresh;
  end;
end;

procedure TTeamList.Button1Click(Sender: TObject);
begin
  TeamList.Enabled := False;
  Application.CreateForm(TTeamsForm, TeamsForm);
  TeamsForm.Enter;
end;

procedure TTeamList.AmendClick(Sender: TObject);
begin
  TeamList.Enabled := False;
  Application.CreateForm(TTeamsForm, TeamsForm);
  TeamsForm.Edit(TeamTeamName.Value);
end;

procedure TTeamList.FormClose(Sender: TObject; var Action: TCloseAction);
begin
Action := caFree;
end;

end.
